#!/bin/sh

OLD_LD_PRELOAD=$LD_PRELOAD
LD_PRELOAD=
export LD_PRELOAD

#First find ALLINEA_TOOLS_PATH
_CWD=`pwd`

# Follow symlinks
CANONICAL_EXE=`readlink -f $0 2>/dev/null`
if [ $? -ne 0 ]; then
        CANONICAL_EXE="$0"
fi

cd `dirname $CANONICAL_EXE`/..
ALLINEA_TOOLS_PATH=`pwd`
cd $_CWD

# DDTPATH is an alias of ALLINEA_TOOLS_PATH for backwards compatibility
DDTPATH=$ALLINEA_TOOLS_PATH
export DDTPATH
export ALLINEA_TOOLS_PATH

PATH=$ALLINEA_TOOLS_PATH/bin:$PATH
export PATH

# check these, particularly the 32/64bit ones on non-linux system
LD_LIBRARY_PATH=$ALLINEA_TOOLS_PATH/lib:$LD_LIBRARY_PATH
SHLIB_PATH=$ALLINEA_TOOLS_PATH/lib:$SHLIB_PATH
LIBPATH=$ALLINEA_TOOLS_PATH/lib:$LIBPATH
LD_LIBRARY_PATH=$ALLINEA_TOOLS_PATH/lib/32:$LD_LIBRARY_PATH
SHLIB_PATH=$ALLINEA_TOOLS_PATH/lib/32:$SHLIB_PATH
LIBPATH=$ALLINEA_TOOLS_PATH/lib/32:$LIBPATH
LD_LIBRARY_PATH=$ALLINEA_TOOLS_PATH/lib/64:$LD_LIBRARY_PATH 
SHLIB_PATH=$ALLINEA_TOOLS_PATH/lib/64:$SHLIB_PATH
LIBPATH=$ALLINEA_TOOLS_PATH/lib/64:$LIBPATH
export LD_LIBRARY_PATH
export SHLIB_PATH
export LIBPATH

LD_PRELOAD=$OLD_LD_PRELOAD

exec "$ALLINEA_TOOLS_PATH/bin/ddt-debugger" --ddtmanuallaunch "$@"
